(function(a){a.path={};var b={rotate:function(a,b){var c=b*Math.PI/180,d=Math.cos(c),e=Math.sin(c);return[d*a[0]-e*a[1],e*a[0]+d*a[1]]},scale:function(a,b){return[b*a[0],b*a[1]]},add:function(a,b){return[a[0]+b[0],a[1]+b[1]]},minus:function(a,b){return[a[0]-b[0],a[1]-b[1]]}};a.path.bezier=function(c,d){c.start=a.extend({angle:0,length:.3333},c.start),c.end=a.extend({angle:0,length:.3333},c.end),this.p1=[c.start.x,c.start.y],this.p4=[c.end.x,c.end.y];var e=b.minus(this.p4,this.p1),f=b.scale(e,c.start.length),g=b.scale(e,-1),h=b.scale(g,c.end.length);f=b.rotate(f,c.start.angle),this.p2=b.add(this.p1,f),h=b.rotate(h,c.end.angle),this.p3=b.add(this.p4,h),this.f1=function(a){return a*a*a},this.f2=function(a){return 3*a*a*(1-a)},this.f3=function(a){return 3*a*(1-a)*(1-a)},this.f4=function(a){return(1-a)*(1-a)*(1-a)},this.css=function(a){var b=this.f1(a),c=this.f2(a),e=this.f3(a),f=this.f4(a),g={};return d&&(g.prevX=this.x,g.prevY=this.y),g.x=this.x=this.p1[0]*b+this.p2[0]*c+this.p3[0]*e+this.p4[0]*f+.5|0,g.y=this.y=this.p1[1]*b+this.p2[1]*c+this.p3[1]*e+this.p4[1]*f+.5|0,g.left=g.x+"px",g.top=g.y+"px",g}},a.path.arc=function(a,b){for(var c in a)this[c]=a[c];this.dir=this.dir||1;while(this.start>this.end&&this.dir>0)this.start-=360;while(this.start<this.end&&this.dir<0)this.start+=360;this.css=function(a){var c=(this.start*a+this.end*(1-a))*Math.PI/180,d={};return b&&(d.prevX=this.x,d.prevY=this.y),d.x=this.x=Math.sin(c)*this.radius+this.center[0]+.5|0,d.y=this.y=Math.cos(c)*this.radius+this.center[1]+.5|0,d.left=d.x+"px",d.top=d.y+"px",d}},a.fx.step.path=function(b){var c=b.end.css(1-b.pos);c.prevX!=null&&a.cssHooks.transform.set(b.elem,"rotate("+Math.atan2(c.prevY-c.y,c.prevX-c.x)+")"),b.elem.style.top=c.top,b.elem.style.left=c.left},a.fn.curve=function(b,c){var d=a.extend({target:"body",trigger:"click",startLength:.1,startAngle:0,endLength:1,endAngle:-30,duration:1e3,parent:".holder",thumb:".thumb",addedDuration:1e3},b);this.each(function(){var b=a(d.parent).find(d.thumb),e=a(d.target);a(this).on(d.trigger,function(f){d.trigger==="click"&&f.preventDefault();var g=b.offset(),h=e.offset(),i=b.clone().addClass("moving");a("body").append(i),i.css({position:"absolute",left:g.left,top:g.top});var j={x:g.left,y:g.top,angle:d.startAngle,length:d.startLength},k={x:h.left,y:h.top,angle:d.endAngle,length:d.endLength};i.animate({path:new a.path.bezier({start:j,end:k})},d.duration,function(){i.remove(),c&&c.call(this),e.addClass("added"),setTimeout(function(){e.removeClass("added")},d.addedDuration)})})})}})(jQuery);
